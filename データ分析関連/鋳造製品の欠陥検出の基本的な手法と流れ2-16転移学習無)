学習済みモデルでの未知データに対しての推論
学習済みモデルを用いて未知データに対しての推論を行います。
推論と言ってもモデルの学習時と変わらず、DataLoaderを用いてモデルに画像データをインプットし、アウトプットを確認する流れ
推論用のデータセットと学習済みモデルのロード、データとラベルとのマッピング用csv(df_test.csv)の読み込みまでは実施済みの状態にて、
下記のプログラムを実行

pred = []

# データの取り出し
for i,(inputs, labels) in enumerate(test_dataloader):

    inputs = inputs.to(DEVICE)
    
    # 学習済みモデルを推論モードに設定
    best_model.eval()
    
    # 学習済みモデルにデータをインプットし、推論をさせる
    outputs = best_model(inputs)
    
    # アウトプットから推定されたラベルを取得
    _, preds = torch.max(outputs, 1)
    
    # 事前に用意したリストに推論結果(0 or 1)を格納
    pred.append(preds.item())

df_test['pred'] = pred

まず、事前にpredというリストを用意します。
そこからtest_dataloaderを用いて、モデルが読み込めるように変換されたデータを1枚ずつ（=バッチサイズが1のため）取り出します。
モデルに対してインプットを入力した際のアウトプットは、正常品だと判断したか欠陥品と判断したかの2値分類となっているため、
出力も[0.121,0.912]などの2クラスとなっています。
そのため、torch.max(outputs, 1)を用い、最も高い値のindexを取得し、このindexがモデルの予測したラベル(0 or 1)となります。
