前回と変わらずシンプルなアボカドのデータです。
最終的にはこのデータを使って、アボカドの販売量予測モデルを作成していきます。
モデルを作成するために、まず欠損値があるかを確認してみましょう。
欠損値の確認には、.isnull()を用います。
いくつか販売量の値が欠損となっておりレコードが見つかりました。
まず何故欠損となっているかが重要となります。実業務では欠損になっている理由を考えることも重要です。

今回は計測漏れにより、データが取得できず欠損となってしまったと仮定します。
その場合はどの値で欠損を補完すれば良いでしょうか。選択問題を通して考えてみましょう。

指数加重移動平均を算出します。

# 指数加重移動平均の算出
ewm_mean = df['Total Volume'].ewm(span=90).mean()  
df['ewm_mean'] = ewm_mean
その後、Total Volumeが欠損のレコードに対して、ewm_meanの値を代入します。
このような代入を行う時はlocを用いましょう。
df.loc[df['Total Volume'].isnull(),'Total Volume']=df[df['Total Volume'].isnull()]['ewm_mean']
