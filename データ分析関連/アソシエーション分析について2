同時購買表の作成 1
バスケット分析のために必要な同時購買表を作成
バスケット分析とは、買い物の際に一緒にカゴに入れる商品は何かを分析するための手法
アソシエーション分析は、両者の関連があるかどうか分析する手法であるためにバスケット分析は、アソシエーション分析の１つになります。
バスケット分析をする際に、どんな商品が一緒に売れているかを調べるために同時購買表はとても有効です。
同時購買表は、縦軸に請求書番号、横軸に商品名とすることで、一緒に購入した商品を可視化して見ることができます。
請求書番号と商品情報をキーに商品個数を集計します。これは、pandasライブラリのpivot_table()関数を使用します。
この関数により、ピボットテーブルのような形式でデータを表に変換して出力
pd.pivot_table()
引数	説明
data	使用するデータ
index	集計し表を作成する際の、行の指定（カラム名を記述）
columns	集計し表を作成する際の、列の指定（カラム名を記述）
values	集計し表を作成する際の、結果の指定（カラム名を記述）
aggfunc	集計し表を作成する際の、結果の計算方法（統計手法を記述）
fill_value	集計し表を作成する際の、欠損値を補完する値を指定します。
# データの読み込み
import pandas as pd
data = pd.read_csv('data.tsv', sep='\t')


# 欠損値を含む行を削除し、再び変数dataに代入
data = data.dropna()

# 国名カラムから特定の国のデータを抽出
Italy = data[data["Country"]=="Italy"]

# 請求書番号と商品情報をキーに商品個数を集計する
basket = pd.pivot_table(data=Italy,index='InvoiceNo',columns='Description',values='Quantity', aggfunc='sum',fill_value=0)

print(basket)
